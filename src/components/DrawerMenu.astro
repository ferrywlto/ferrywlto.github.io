---
import HeaderLink from './HeaderLink.astro';
---

<div class="drawer-overlay" x-show="open" x-transition.opacity.duration.300ms x-on:click="open = false"></div>
<div class="drawer" x-show="open" 
     x-transition:enter="drawer-enter" 
     x-transition:enter-start="drawer-enter-start" 
     x-transition:enter-end="drawer-enter-end"
     x-transition:leave="drawer-leave" 
     x-transition:leave-start="drawer-leave-start" 
     x-transition:leave-end="drawer-leave-end">
	<div class="drawer-header">
		<h2>Menu</h2>
		<button class="close-btn" x-on:click="open = false" aria-label="Close menu">
			<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</button>
	</div>
	<nav class="drawer-nav">
		<HeaderLink href="/" x-on:click="open = false">Home</HeaderLink>
		<HeaderLink href="/about" x-on:click="open = false">About</HeaderLink>
		<HeaderLink href="/blog" x-on:click="open = false">Blog</HeaderLink>
		<HeaderLink href="/tags" x-on:click="open = false">Tags</HeaderLink>
	</nav>
</div>

<style>
	/* Alpine.js transition classes */
	.drawer-enter {
		transition: transform 300ms ease-out;
	}
	.drawer-enter-start {
		transform: translateX(-100%);
	}
	.drawer-enter-end {
		transform: translateX(0);
	}
	.drawer-leave {
		transition: transform 300ms ease-in;
	}
	.drawer-leave-start {
		transform: translateX(0);
	}
	.drawer-leave-end {
		transform: translateX(-100%);
	}

	.drawer-overlay {
		position: fixed;
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		background: rgba(0, 0, 0, 0.4);
		backdrop-filter: blur(8px) brightness(0.8);
		-webkit-backdrop-filter: blur(8px) brightness(0.8);
		z-index: 998;
	}

	.drawer {
		position: fixed;
		top: 0;
		left: 0;
		width: 300px;
		max-width: 80vw;
		height: 100vh;
		background: rgba(248, 249, 250, 0.9);
		backdrop-filter: blur(20px) saturate(180%);
		-webkit-backdrop-filter: blur(20px) saturate(180%);
		z-index: 999;
		box-shadow: 
			4px 0 25px rgba(0, 0, 0, 0.1),
			0 0 0 1px rgba(255, 255, 255, 0.2);
		display: flex;
		flex-direction: column;
	}

	.drawer-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: 1.5rem 1.5rem 1rem 1.5rem;
		border-bottom: 1px solid rgba(255, 255, 255, 0.2);
		background: rgba(255, 255, 255, 0.15);
		backdrop-filter: blur(10px);
		-webkit-backdrop-filter: blur(10px);
		position: relative;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
	}

	.drawer-header::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
		z-index: -1;
	}

	.drawer-header h2 {
		margin: 0;
		color: rgb(var(--black));
		font-size: 1.5rem;
	}

	.close-btn {
		background: none;
		border: none;
		cursor: pointer;
		padding: 0.5rem;
		border-radius: 8px;
		color: rgb(var(--gray));
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		display: flex;
		align-items: center;
		justify-content: center;
		position: relative;
		overflow: hidden;
	}

	.close-btn::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		width: 0;
		height: 100%;
		background: linear-gradient(135deg, rgba(var(--accent), 0.15), rgba(var(--accent), 0.08));
		transition: width 0.3s ease;
		z-index: -1;
	}

	.close-btn:hover {
		background: rgba(var(--accent), 0.1);
		color: var(--accent-dark);
		transform: scale(1.1) rotate(90deg);
		box-shadow: 0 4px 12px rgba(var(--accent), 0.2);
	}

	.close-btn:hover::before {
		width: 100%;
	}

	.close-btn:active {
		transform: scale(0.95) rotate(90deg);
	}

	.drawer-nav {
		flex: 1;
		padding: 0;
		margin: 0;
		overflow-y: auto;
		width: 100%;
		border: none;
		outline: none;
		/* Reset any inherited nav styles */
		position: relative;
		left: 0;
		top: 0;
		background: none;
		list-style: none;
	}

	.drawer-nav :global(a) {
		display: block;
		padding: 1rem 1.5rem;
		margin: 0;
		text-decoration: none;
		color: rgb(var(--gray-dark));
		font-size: 1.1rem;
		font-weight: 500;
		border-left: 4px solid transparent;
		transition: all 0.3s ease-out;
		position: relative;
		overflow: hidden;
		box-sizing: border-box;
		width: 100%;
	}

	.drawer-nav :global(a::before) {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		width: 0;
		height: 100%;
		background: linear-gradient(90deg, rgba(var(--accent), 0.2), rgba(var(--accent), 0.1));
		transition: width 0.3s ease-out;
		z-index: -1;
	}

	.drawer-nav :global(a:hover) {
		background: linear-gradient(90deg, rgba(var(--accent), 0.18), rgba(var(--accent), 0.08));
		border-left-color: var(--accent);
		color: var(--accent-dark);
		backdrop-filter: blur(8px) saturate(120%);
		-webkit-backdrop-filter: blur(8px) saturate(120%);
		box-shadow: 
			inset 0 0 20px rgba(var(--accent), 0.15),
			0 0 0 1px rgba(var(--accent), 0.2);
		font-weight: 600;
	}

	.drawer-nav :global(a:hover::before) {
		width: 100%;
	}

	.drawer-nav :global(a.active) {
		background: linear-gradient(135deg, var(--accent), var(--accent-dark) 70%);
		color: white;
		border-left-color: var(--accent-dark);
		font-weight: 700;
		backdrop-filter: blur(8px) saturate(150%);
		-webkit-backdrop-filter: blur(8px) saturate(150%);
		box-shadow: 
			inset 0 0 20px rgba(0, 0, 0, 0.15),
			0 4px 15px rgba(var(--accent), 0.4),
			0 0 0 1px rgba(255, 255, 255, 0.2);
		text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
	}

	.drawer-nav :global(a.active::before) {
		width: 100%;
		background: linear-gradient(90deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
	}

	/* Responsive adjustments */
	@media (max-width: 480px) {
		.drawer {
			width: 260px;
		}
		
		.drawer-header {
			padding: 1rem 1rem 0.75rem 1rem;
		}
		
		.drawer-header h2 {
			font-size: 1.3rem;
		}
		
		.drawer-nav :global(a) {
			padding: 0.875rem 1rem;
			font-size: 1rem;
		}
	}		/* Hide drawer on desktop */
	@media (min-width: 720px) {
		.drawer,
		.drawer-overlay {
			display: none !important;
		}
	}
	
	/* Ensure drawer is above all other elements */
	.drawer-overlay,
	.drawer {
		position: fixed;
		z-index: 998;
	}
	
	.drawer {
		z-index: 999;
	}
</style>
