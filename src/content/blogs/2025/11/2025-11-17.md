---
title: 'Creating iOS Widgets with MAUI‚Ää-‚ÄäPart 3: Communicating between MAUI App and iOS¬†Widget'
description: 'Exploring the communication between a MAUI app and its iOS widget.'
pubDate: 2025-11-17
tags: [dotnet, maui, ios, xcode, mobile-development]
heroImage: "tbd"
---

This is the last part of the series recording how I managed to create a MAUI app that can interact with an iOS widget. In this post, we will explore how to communicate between the iOS widget and have our MAUI app created from the previous posts. I highly recommend reading the first and second post, [Creating iOS Widgets with MAUI‚Ää-‚ÄäPart 1: Interoperability](https://ferrywlto.medium.com/creating-ios-widgets-with-maui-part-1-interoperability-d73d6f2c563c?postPublishedType=repub) and [Creating iOS Widgets with MAUI‚Ää-‚ÄäPart 2: Bundling iOS Widget](https://ferrywlto.medium.com/creating-ios-widgets-with-maui-part-2-bundling-ios-widget-5c5f5f5f5f5?postPublishedType=repub), if you haven't read them yet, as the topic in this post will require knowledge from the previous ones.

Disclaimer: I am just sharing my personal experience. I do not guarantee the information in this post is 100% correct or accurate. I am not, by any means, expressing that I am an expert in mobile development.

## Sharing data between MAUI app and iOS¬†widget

To share data between the MAUI app and the iOS widget, we can use App Groups. App Groups allow multiple apps or extensions to share access to a common container.

We need to make sure both of our MAUI app and the iOS widget are part of the same App Group.

In Xcode:
1. Open the widget extension target project created in Part 2.
2. Create a `.entitlements` file for the widget extension if you haven't done so. Name it to something like `HelloWidgetExtension.entitlements`.
3. Open the `.entitlements` file and add the following:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>com.apple.security.application-groups</key>
	<array>
    <!-- Replace with your app bundle identifier -->
		<string>group.MyOrg.hello-maui-widget</string>
	</array>
</dict>
</plist>
```

Note: App Group identifiers must be prefixed with `group.`, it is Apple's convention.

Back to the MAUI app project:
1. Go to `Platforms/iOS` folder, create a new file named `Entitlements.plist` if it doesn't exist. 
2. Copy the same content from the widget extension's `.entitlements` file into this file.


Now we will make use of `NSUserDefaults` with the App Group to share data.

Think of it as an in-memory key-value storage that both the MAUI app and the iOS widget can access, just like using Redis. iOS manages when the values are flushed to persistent storage.

What we are trying to do is to have the MAUI app write a value to the shared `NSUserDefaults`, and call the bridge to have the iOS widget read that value and display it.

3. Open `MainPage.xaml.cs` in your MAUI project, and add the following code above the `HelloWorldBridge.SayHelloStaticLib();` line we added in Part 1:

```csharp
// replace with group.[your_app_group_identifier] 
using var defaults = new NSUserDefaults("group.MyOrg.hello-maui-widget", NSUserDefaultsType.SuiteName);
defaults.SetString(count.ToString(), "helloValue");
```

We have just written the current counter value to the shared `NSUserDefaults` with key `helloValue`.

Now the last piece of the puzzle is to have the iOS widget read that value and display it.

# Reload widget timeline

In part 1, the exported Swift function `HelloWorldBridge_SayHello` simply logged a hello message. Now we will modify it such that when it is called, it will reload the widget data source.

Open the `HelloWorldBridge.swift` file we created in Part 1, and modify the function to the following:

```swift
@_cdecl("HelloWorldBridge_SayHello")
public func HelloWorldBridge_SayHello() {
    WidgetCenter.shared.reloadAllTimelines()
}
```

This will instruct the singleton WidgetCenter to reload all widget timelines belonging to the containing app. The current timeline will get invalidated, and the system will call the timeline provider to get new data. So the next step is to modify our timeline provider to read the shared data.

Open the `HelloWidget.swift` file created in Part 2, and modify the `getTimeline` method in `Provider` struct generated by Xcode as below:

```swift
func getTimeline(in context: Context, completion: @escaping (Timeline<Entry>) -> ()) {
    let defaults = UserDefaults(suiteName: "group.MyOrg.hello-maui-widget")
    let helloValue = defaults?.string(forKey: "helloValue") ?? "0"
    
    var entries: [SimpleEntry] = []
    let entryDate = Calendar.current.date(byAdding: .minute, value: 1, to: .now)!

    let entry = SimpleEntry(date: entryDate, emoji: "üòÄ Count: \(helloValue)")
    entries.append(entry)

    let timeline = Timeline(entries: entries, policy: .atEnd)
    completion(timeline)
}
```
What we did here is to read the shared `NSUserDefaults` with the same app group, get the value for key `helloValue`, and use it to create a new timeline entry.

When `WidgetCenter.shared.reloadAllTimelines()` is called from the MAUI app, `getTimeline` will be invoked, updating the widget's display and schedule next refresh. We set it to 1 minute for demo purposes, but the actual refresh time is managed by iOS and not guaranteed, subject to WidgetKit‚Äôs budget and OS heuristics.

Build the widget extension and copy the updated `HelloWidgetExtension.appex` to the MAUI project's `Platforms/iOS/PlugIns` folder as we did in Part 2.

Rebuild and run the MAUI app again.

Now you should be able to see that when you tap the button in the MAUI app, the counter value is updated in the iOS widget.

![gif]()
üéâ **Congratulations!** You have successfully created a MAUI app that can communicate with an iOS widget. üëè

After going through this series, you should be able to:
- Create an iOS widget and embed it into a MAUI app.
- Call Swift code from C# in a MAUI app.
- Share data between a MAUI app and its iOS widget using App Groups and `NSUserDefaults`.

Hope you find this series helpful. Happy coding!

The full source code of this demo project can be found at my [GitHub repository](https://github.com/ferrywlto/hello-maui-widget)

This post is originally published on [Medium](https://ferrywlto.medium.com/creating-ios-widgets-with-maui-part-2-bundling-ios-widget-7f3f3f4e4f3c?postPublishedType=repub).

https://ferrywl.to/blogs/2025/11/2025-11-16/
